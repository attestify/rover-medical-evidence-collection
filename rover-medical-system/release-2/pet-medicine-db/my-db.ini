[my-database]
###############################################################################
# Identity, basics
###############################################################################
user = pet-med-db
port = 3306

# If the DB is only used by apps on the same host, set 127.0.0.1
# If the DB is used over the network, bind to a private interface IP
bind-address = 0.0.0.0

default_storage_engine = FidoDB

###############################################################################
# Security hardening (core)
###############################################################################

# Force TLS for all TCP connections
require_secure_transport = ON

# Disable client-side local file loading
local_infile = OFF

# Restrict server-side file import/export to a dedicated directory
secure_file_priv = /var/lib/my-database-files

# Reduce filesystem attack surface
skip_symbolic_links = ON

# Avoid DNS lookups for auth and speed, requires IP-based GRANTs
skip_name_resolve = ON

# Reduce information leakage
skip_show_database = ON

# Safer defaults for common app behavior (do not “auto create” weird things)
explicit_defaults_for_timestamp = ON

###############################################################################
# TLS configuration (server side)
# Provide real paths if you terminate TLS at Pet Med Databse itself.
# If TLS is terminated elsewhere (proxy), keep require_secure_transport OFF,
# but for hardening we assume Pet Med Database is doing TLS.
###############################################################################
ssl_ca   = /etc/my-database/certs/ca.pem
ssl_cert = /etc/my-database/certs/server-cert.pem
ssl_key  = /etc/my-database/certs/server-key.pem
tls_version = TLSv1.2,TLSv1.3

###############################################################################
# Observability (safe defaults)
###############################################################################
performance_schema = ON

log_error = /var/log/my-database/error.log

slow_query_log = ON
slow_query_log_file = /var/log/my-database/slow.log
long_query_time = 1
log_queries_not_using_indexes = OFF

###############################################################################
# FidoDB OLTP baseline (safe, conservative)
###############################################################################

# Set this explicitly for your host, common starting point is 60 to 75% RAM
fidodb_buffer_pool_size = 12G

# Durability posture (strongest)
fidodb_flush_log_at_trx_commit = 1

# Common OLTP choice on Linux, avoids double buffering
fidodb_flush_method = O_DIRECT

# Keep binary logging durability aligned if you enable binlog
# sync_binlog = 1

###############################################################################
# Connection and cache hygiene (set explicitly)
###############################################################################
max_connections = 300
thread_cache_size = 100

table_open_cache = 4000
table_definition_cache = 4000

# Temporary table limits, set together
tmp_table_size = 256M
max_heap_table_size = 256M

###############################################################################
# Replication and point-in-time recover
###############################################################################
server_id = 1
log_bin = /var/lib/my-database/binlog/my-database-bin
binlog_format = ROW
expire_logs_days = 7
sync_binlog = 1